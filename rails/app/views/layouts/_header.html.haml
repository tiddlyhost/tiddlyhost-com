
%nav.navbar.navbar-dark.navbar-expand-sm.bg-gradient{ class: navbar_prod }
  .container-fluid
    -#
    -# Logo
    -#
    = link_to(root_path, class: 'navbar-brand', title: 'Tiddlyhost') do
      = image_tag("logo.svg", style: "height:32px;margin-left:12px;opacity:80%;")

    -#
    -# Burger button for phone screens
    -#
    %button.navbar-toggler(type="button"
      data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation")
      %span.navbar-toggler-icon

    -#
    -# Nav bar content
    -#
    .collapse.navbar-collapse#navbarSupportedContent
      - if user_signed_in?
        -#
        -# Links for logged in users
        -#
        %ul.navbar-nav.me-auto.mb-lg-0
          = nav_link_to "Home", root_path
          = nav_link_to "Explore", '/hub'

          - if user_is_admin?
            = nav_link_to "Admin", admin_path, style: 'opacity: 10%;'

        %ul.navbar-nav.mb-auto
          = dark_mode_toggle_link

          = nav_link_to bi_icon('plus', fill: "white", height: "1.9em", width: "1.9em", style: "opacity: 90%;"),
            new_site_path, li_class: 'd-none d-sm-block', title: 'Create site'

          %li.nav-item.dropdown
            %a.nav-link.dropdown-toggle#navbarDropdown(role="button"
              data-bs-toggle="dropdown" aria-expanded="false" href="#"
              aria-haspopup="true" title="User menu")
              - if current_user.use_gravatar?
                = gravatar_image(current_user, size: 20, style: 'margin-top: -2px;')
              - else
                = bi_icon('person-fill', fill: '#fff', style: 'margin-right: -1px;')
              = current_user.username_or_name

            %ul.dropdown-menu.dropdown-menu-end.th-nav-menu{ 'aria-labelledby'=>'navbarDropdown' }
              = render 'layouts/user_menu_items'

      - else
        -#
        -# Links for not logged in users
        -#
        %ul.navbar-nav.me-auto
          = nav_link_to "Home", root_path
          = nav_link_to "Explore", '/hub'
          = nav_link_to "Sign up", new_user_registration_path

        %ul.navbar-nav.mb-auto
          = dark_mode_toggle_link
          = nav_link_to "Log in", new_user_session_path
